\documentclass{article}\usepackage{makeidx}\makeindexegin{document}\printindex
\section{soil}
% Generated by sldoc (1.14, (C) 1996, 1997) Tue Jan 15 14:51:25 2019


\paragraph{\index{bocobot}bocobot}
\begin{verbatim}
void bocobot(int pt)
\end{verbatim}
Determines the values of the boundary conditions at the bottom of
the soil profile


Returns:  nothing 


from: {\tt soilboun.c}

from file: {\tt doc}


\paragraph{\index{bocotop}bocotop}
\begin{verbatim}
double bocotop (double *kgeo0,int *ftoph)
\end{verbatim}
Determines the top boundary conditions for each day (timestep)


Returns:  qtop


from: {\tt soilboun.c}

from file: {\tt doc}


\paragraph{\index{ckcnv}ckcnv}
\begin{verbatim}
int (*ckcnv)() = NULL;
\end{verbatim}
Pointer to function that checks for convergence. At the
moment 2 are present, th\_ckcnv (swattr method) and mb\_ckcnv
(a new experimental method). The pointer is set in {\tt getparm.c}.


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{cksatu}cksatu}
\begin{verbatim}
int cksatu()
\end{verbatim}
Checks if the profile is completely saturated.
Returns: 1 if completely saturated, otherwise 0


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{detavgthet}detavgthet}
\begin{verbatim}
double detavgtheta(int layr)
\end{verbatim}
Description: determine average theta until (not including) layer layr


Returns: weighted average theta 


from: {\tt misc\_p.c}

from file: {\tt doc}


\paragraph{\index{det\_hatm}det\_hatm}
\begin{verbatim}
double det_hatm(int i)
\end{verbatim}
Description: gets  hatm for step i
Returns: nothing
Remarks: hatm calculation kind of stupid


from: {\tt det\_hatm.c}

from file: {\tt doc}


\paragraph{\index{dethowsat}dethowsat}
\begin{verbatim}
void dethowsat
\end{verbatim}
Description: Determines relative saturation


Returns: nothing 


from: {\tt misc\_p.c}

from file: {\tt doc}


\paragraph{\index{dt}dt}
\begin{verbatim}
double dtmax
\end{verbatim}
Description: maximum allowed dt, default $=$ 0.1


from: {\tt timestep.c}

from file: {\tt doc}


\paragraph{\index{dtm1}dtm1}
\begin{verbatim}
double dtm1
\end{verbatim}
Description: previous dt


from: {\tt timestep.c}

from file: {\tt doc}


\paragraph{\index{dtmax}dtmax}
\begin{verbatim}
double dtmax
\end{verbatim}
Description: maximum allowed dt, default $=$ 0.1


from: {\tt timestep.c}

from file: {\tt doc}


\paragraph{\index{dtmin}dtmin}
\begin{verbatim}
double tmin
\end{verbatim}
Description: minimum allowed dt


from: {\tt timestep.c}

from file: {\tt doc}


\paragraph{\index{fillmat}fillmat}
\begin{verbatim}
void fillmat(double **mat,double a[], double b[], double c[])
\end{verbatim}
Description: Fills the matrix mat in the compact 45oC rotated form
Returns: nothing


from: {\tt band.c}

from file: {\tt doc}


\paragraph{\index{fillmat}fillmat}
\begin{verbatim}
void fillmat(double **mat,double a[], double b[], double c[])
\end{verbatim}
Description: Fills the matrix mat in the compact 45oC rotated form
Returns: nothing


from: {\tt band.c}

from file: {\tt doc}


\paragraph{\index{fluxes}fluxes}
\begin{verbatim}
void fluxes(void)
\end{verbatim}
Determines the fluxes between the nodes and total bottom flux.
Returns: nothing


from: {\tt fluxes.c}

from file: {\tt doc}


\paragraph{\index{freescratch}freescratch}
\begin{verbatim}
void freescratch()
\end{verbatim}
Frees the scratch arrays used in {\tt headcalc()}. This is called from
{\tt postsoil()}


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{getparms}getparms}
\begin{verbatim}
int getparams(char *infilename)
\end{verbatim}
Gets the parameters from the inputfile needed for soil module
Returns: 0 (always)
Remarks: should be cleaned


from: {\tt getparm.c}

from file: {\tt doc}


\paragraph{\index{h2dmc\_0}h2dmc\_0}
\begin{verbatim}
double h2dmc_0 (int nr, double head)
\end{verbatim}
Description: Calculates the differential moisture capacity as a
function of pressure head. This is the Campbel 1994


Returns: differential moisture content


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{h2dmc\_1}h2dmc\_1}
\begin{verbatim}
double h2dmc_1 (int nr, double head)
\end{verbatim}
Calculates the differential moisture capacity as a function of pressure head


Returns: differential moisture capacity


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{h2dmc\_2}h2dmc\_2}


Prototype: double h2dmc\_2 (int nr, double head)


Description: Calculates the differential moisture capacity as a function of pressure head.


Returns: differential moisture capacity 


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{h2t\_0}h2t\_0}
\begin{verbatim}
double h2t_0 (int nr, double head)
\end{verbatim}
Calculate the water content at layer j from pressure
head {\tt head}


Returns: theta


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{h2t\_1}h2t\_1}


Prototype: double h2t\_1 (int nr, double head)


Description: Calculate the water content at layer j from pressure
head, via van Genuchten


Returns: water content theta 


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{h\_by\_banddiag}h\_by\_banddiag}
\begin{verbatim}
void h_by_banddiag()
\end{verbatim}
Description: Solves the tridiagonal matrix as if it was a more
general band-diagonal matrix. This is only needed if a zero pivot
occurs in tridiag. This is seldom needed.


Returns: nothing+


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{h\_by\_tridiag}h\_by\_tridiag}
\begin{verbatim}
int h_by_tridiag()
\end{verbatim}
Description: Solves the matrix by the simple and fast algorithm for
a tridiagonal matrix. If a zero pivot occurs it exits and returns 1
and the more general method for solving band-diagonal matrixes
should be used. 0 is returned on success


Returns: 0 on sucess, 1 on failure


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{headcalc}headcalc}
\begin{verbatim}
void headcalc(int pt, double *t)
\end{verbatim}
This is the new revamped headcalc. It first checks to see if the
profile is completely saturated. If so a trick from {\tt swat91} is
used ({\tt h\_sat()}) the change to profile to almost saturated.
Unsaturated flow is first solved via a tridiagonal matrix
solution. In some cases this fails and a more general (band
diagonal) solution is used (See Press et al) which is somewhat
slower but more robust


Returns: 1 if convergence failed, 0 if success 


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{h\_itt}h\_itt}
\begin{verbatim}
void h_itt()
\end{verbatim}
Calculates new head via LU decomposition and uses 2 xtra itterations
to get full machine precision in the solution. It is the slowest
of the three possible solutions.


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{h\_satu}h\_satu}
\begin{verbatim}
void h_satu()
\end{verbatim}
Changes the profile from completely saturated to almost saturated


Returns: nothing 


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{initial}initial}
\begin{verbatim}
void initial()
\end{verbatim}
Sets initial values


Return:  nothing


from: {\tt swatsoil.c}

from file: {\tt doc}


\paragraph{\index{intergral}intergral}
\begin{verbatim}
void integral(int i)
\end{verbatim}
Integrate variables over timestep and calculates mass bal


from: {\tt integral.c}

from file: {\tt doc}


\paragraph{\index{mat\_cof\_up}mat\_cof\_up}
\begin{verbatim}
void mat_cof_up(void)
\end{verbatim}
Description: Updated the coeffcients b,f of the tridiagonal
matrix. This is used in the iteration step.


Returns: nothing


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{mkscratch}mkscratch}
@void mkscratch()
Allocated the scratch arrays needed in {\tt headcalc()}. They are freed
in {\tt freescratch}.


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{mktblinter}mktblinter}
\begin{verbatim}
double *mktblinter(int layer,int nrpoints,double min, double max)
\end{verbatim}
Makes an increasing theta array taking into account the slope of
the theta 2 k relation
Returns: Theta array


from: {\tt filltab.c}

from file: {\tt doc}


\paragraph{\index{ntridiag}ntridiag}
\begin{verbatim}
int ntridiag(double *fa,double *fb,double *fc, double *f, double
*res, double *greekb, double *greekc, int n)
\end{verbatim}
Description: Solves the matrix by the simple and fast algorithm for
a tridiagonal matrix. If a zero pivot occurs it exits and returns 1
and the more general method for solving band-diagonal matrixes
should be used. 0 is returned on success


Returns: 0 on sucess, 1 on failure


from: {\tt nhc.c}

from file: {\tt doc}


\paragraph{\index{ntridiag}ntridiag}
\begin{verbatim}
int ntridiag(double *fa,double *fb,double *fc, double *f, double
*res, double *greekb, double *greekc, int n)
\end{verbatim}
Description: Solves the matrix by the simple and fast algorithm for
a tridiagonal matrix. If a zero pivot occurs it exits and returns 1
and the more general method for solving band-diagonal matrixes
should be used. 0 is returned on success


Returns: 0 on sucess, 1 on failure


from: {\tt nhc.c}

from file: {\tt doc}


\paragraph{\index{postsoil}postsoil}


Prototype:  void postsoil()


Description:  Cleans up after presoil and tstep\_soil. Frees all mem


Returns:  nothing+


from: {\tt swatsoil.c}

from file: {\tt doc}


\paragraph{\index{readstype}readstype}
\begin{verbatim}
int readstype (char *section, char *fname, int layer)
\end{verbatim}
Allocates new sp if needed and reads soil parameters
from section and calls one of the method specific read functions


Returns: index of sp linked to node 


from: {\tt swatsoil.c}

from file: {\tt doc}


\paragraph{\index{readvangenu}readvangenu}
\begin{verbatim}
void readvangenu(char *secname, int spnr, int layer)
\end{verbatim}
Description:  read van gunuchten stuff for layer layer and soilinfo spnr


Returns:  nothing


from: {\tt swatsoil.c}

from file: {\tt doc}


\paragraph{\index{reduceeva}reduceeva}
\begin{verbatim}
double reduceva (int swreduc)
\end{verbatim}
Calculates reduction of soil evaporation


Returns reducted soil evaporation 


from: {\tt reduceva.c}

from file: {\tt doc}


\paragraph{\index{savevars}savevars}
\begin{verbatim}
void savevars()
\end{verbatim}
Description: Saves spare copies of the h, theta and diffmoist arrays


Returns: nothing


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{setzero}setzero}
\begin{verbatim}
void setzero(void)
\end{verbatim}
sets intemediate totals to zero


Returns:  nothing 


from: {\tt setzero.c}

from file: {\tt doc}


\paragraph{\index{smd}smd}
\begin{verbatim}
double smd(double drz,doubel fieldh)
\end{verbatim}
calculates the soil moisture deficit until depth drz
(usually rooting depth) with fieldcapacity at fieldh


Returns:  soil moisture deficit 


from: {\tt misc\_p.c}

from file: {\tt doc}


\paragraph{\index{t2h\_0}t2h\_0}
\begin{verbatim}
double t2h_0 (int nr, double wcon, double depth)
\end{verbatim}
Calculates the pressure heads at layer j from the moisture content
using Clapp$/$Hornberger
Returns: pressure head


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{t2h\_1}t2h\_1}


Prototype: double t2h\_1 (int nr, double wcon, double depth)


Description: Calculates the pressure heads at layer j from the
water content It uses van Genuchten


Returns: pressure head 


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{t2k\_0}t2k\_0}
\begin{verbatim}
double t2k_0(int nr, double wcon)
\end{verbatim}
Description: Calculation of hydraulic conductivity from water
content. Clapp Hornberger, or a look up table. This replaces
hconode()


Returns: k\_unsat


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{t2k\_1}t2k\_1}


Prototype: double t2k\_1(int nr, double wcon)


Description: Calculation of hydraulic conductivity from water content. Via van Genuchten


Returns: k\_unsat 


from: {\tt soilut.c}

from file: {\tt doc}


\paragraph{\index{t}t}
\begin{verbatim}
int th_ckcnv()
\end{verbatim}
original swatr method to check convergence


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{th\_ckcnv}th\_ckcnv}
\begin{verbatim}
int th_ckcnv()
\end{verbatim}
original swatr method to check convergence


from: {\tt headcalc.c}

from file: {\tt doc}


\paragraph{\index{thetol}thetol}
\begin{verbatim}
double thetol
\end{verbatim}
Maximum allowed change of theta at this dt, default $=$ 0.00001


from: {\tt timestep.c}

from file: {\tt doc}


\paragraph{\index{timestep}timestep}
\begin{verbatim}
double timestep(double t, double e_t, double *dt, double *dtm1)
\end{verbatim}
Description: Calculation of timestep ({\tt dt}) depending on theta
changes and actual time (t). Step is synchronized to {\tt e\_t} (end
of timestep.


Return: new timestep (dt)


from: {\tt timestep.c}

from file: {\tt doc}


\paragraph{\index{tm1}tm1}
\begin{verbatim}
double tm1
\end{verbatim}
Description: previous time


from: {\tt timestep.c}

from file: {\tt doc}


\paragraph{\index{tstep\_soil}tstep\_soil}
\begin{verbatim}
void tstep_soil (int i,double e_t, double t_prec, double t_intc,double t_ptra,
            double t_peva)
\end{verbatim}
Description: Calculated theta etc for end of time in record  i
of the precipitation file. This is the core of the soil module


Returns: nothing


from: {\tt swatsoil.c}

from file: {\tt doc}


\paragraph{\index{watcon}watcon}
\begin{verbatim}
void watcon(void)
\end{verbatim}
Determines the actual water content of the profile


from: {\tt soilut.c}

from file: {\tt doc}
nd{document}
